{"ast":null,"code":"import _slicedToArray from \"/Users/jacksonfoster/Code/projects/payroll-pal/front-end/payroll-pal/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/jacksonfoster/Code/projects/payroll-pal/front-end/payroll-pal/src/CoreComponents/EntriesList.js\";\nimport React, { useContext, useEffect, useState } from \"react\";\nimport Entry from \"./Entry\";\nimport EntryHeading from \"./EntryHeading\";\nimport PayrollPalClient, { Heartbeat } from '../payroll-pal-client';\nimport { CoreContext } from './Core';\nimport AuthContext from '../AuthContext';\n\nfunction EntriesList() {\n  const coreContext = useContext(CoreContext);\n  const authContext = useContext(AuthContext);\n  const payPeriodStart = coreContext.payPeriodStart;\n  const payPeriodEnd = coreContext.payPeriodEnd;\n\n  const _useState = useState(true),\n        _useState2 = _slicedToArray(_useState, 2),\n        loading = _useState2[0],\n        setLoading = _useState2[1];\n\n  useEffect(() => {\n    let hb = setInterval(function () {\n      Heartbeat().catch(error => {\n        clearInterval(hb);\n        authContext.logout();\n      });\n    }, 30000);\n    PayrollPalClient.getEntries().then(result => {\n      if (result.error) {\n        if (result.status_code === 401) {\n          coreContext.setState({\n            error401: true\n          });\n          authContext.logout();\n        } else {\n          coreContext.setState({\n            error: true\n          });\n          authContext.logout();\n        }\n      } else {\n        coreContext.setState({\n          loading: false,\n          entries: result['entries'],\n          firstName: result['firstName'],\n          payPeriodStart: result['payPeriodStart'],\n          payPeriodEnd: result['payPeriodEnd'],\n          payRate: result['payRate'],\n          totalHours: result['totalHours'],\n          allApproved: false\n        });\n      }\n    });\n  }, []);\n  useEffect(() => {\n    setLoading(true);\n    PayrollPalClient.getEntries(payPeriodStart, payPeriodEnd).then(result => {\n      coreContext.setEntries(result['entries']);\n      coreContext.setFirstName(result['firstName']);\n      coreContext.setPayRate(result['payRate']);\n      coreContext.setTotalHours(result['totalHours']);\n      setLoading(false);\n    });\n  }, [payPeriodStart, payPeriodEnd]);\n  return React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68\n    },\n    __self: this\n  }, coreContext.payPeriodStart ? React.createElement(EntryHeading, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70\n    },\n    __self: this\n  }) : React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70\n    },\n    __self: this\n  }), React.createElement(\"div\", {\n    className: loading ? \"\" : \"d-none\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72\n    },\n    __self: this\n  }, \" Loading...\"), React.createElement(\"div\", {\n    className: loading ? \"d-none\" : \"\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73\n    },\n    __self: this\n  }, coreContext['entries'] ? coreContext['entries'].map((entry, index) => {\n    return React.createElement(Entry, Object.assign({}, entry, {\n      index: index,\n      key: index,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 75\n      },\n      __self: this\n    }));\n  }) : null));\n}\n\nexport default EntriesList;","map":{"version":3,"sources":["/Users/jacksonfoster/Code/projects/payroll-pal/front-end/payroll-pal/src/CoreComponents/EntriesList.js"],"names":["React","useContext","useEffect","useState","Entry","EntryHeading","PayrollPalClient","Heartbeat","CoreContext","AuthContext","EntriesList","coreContext","authContext","payPeriodStart","payPeriodEnd","loading","setLoading","hb","setInterval","catch","error","clearInterval","logout","getEntries","then","result","status_code","setState","error401","entries","firstName","payRate","totalHours","allApproved","setEntries","setFirstName","setPayRate","setTotalHours","map","entry","index"],"mappings":"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","sourcesContent":["import React, { useContext, useEffect, useState } from \"react\";\nimport Entry from \"./Entry\";\nimport EntryHeading from \"./EntryHeading\";\nimport PayrollPalClient, { Heartbeat } from '../payroll-pal-client'\nimport { CoreContext } from './Core'\nimport AuthContext from '../AuthContext'\n\nfunction EntriesList() {\n    const coreContext = useContext(CoreContext)\n    const authContext = useContext(AuthContext)\n    const payPeriodStart = coreContext.payPeriodStart\n    const payPeriodEnd = coreContext.payPeriodEnd\n    const [loading, setLoading] = useState(true)\n\n    useEffect( () => {\n\n        let hb = setInterval(function () {\n        Heartbeat().catch(\n            (error) => {\n                clearInterval(hb)\n                authContext.logout()\n            }\n        )\n        }, 30000)\n\n    PayrollPalClient.getEntries()\n    .then((result) => {\n        if(result.error){\n          if(result.status_code === 401){\n            coreContext.setState({error401: true})\n            authContext.logout()\n          }\n          else {\n            coreContext.setState({error: true})\n            authContext.logout()\n          }\n        }\n        else {\n          coreContext.setState({\n            loading: false,\n            entries: result['entries'],\n            firstName: result['firstName'],\n            payPeriodStart: result['payPeriodStart'],\n            payPeriodEnd: result['payPeriodEnd'],\n            payRate: result['payRate'],\n            totalHours: result['totalHours'],\n            allApproved: false,\n          })\n        }\n      })\n    }, [])\n\n    useEffect( () => {\n        setLoading(true)\n        PayrollPalClient.getEntries(payPeriodStart, payPeriodEnd).then(\n            (result) => {\n                coreContext.setEntries(result['entries'])\n                coreContext.setFirstName(result['firstName'])\n                coreContext.setPayRate(result['payRate'])\n                coreContext.setTotalHours(result['totalHours'])\n                setLoading(false)\n            },\n        )\n    }, [payPeriodStart, payPeriodEnd]);\n\n    return(\n\n        <div>\n            {\n                coreContext.payPeriodStart ? <EntryHeading /> : <div></div>\n            }\n            <div className={ loading ? \"\" : \"d-none\"}> Loading...</div>\n            <div className={ loading ? \"d-none\" : \"\"}>\n                { coreContext['entries'] ? coreContext['entries'].map((entry, index) => {\n                    return <Entry {...entry} index={index} key={index} /> \n                }) : null}\n            </div>\n\n        </div>\n    )\n}\n\nexport default EntriesList;"]},"metadata":{},"sourceType":"module"}